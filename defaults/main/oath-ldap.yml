---
# defaults file for roles/ae-dir

#---------------------------------------------------------------------------
# OATH-LDAP parameters
#---------------------------------------------------------------------------

# enable OATH-LDAP (with external bind listeners in slapd.conf)
# set to True to enable (default is False=disabled)
oath_ldap_enabled: False

# regex pattern for limiting the entries for which bind requests
# are sent to external OATH-LDAP listener
# Note:
# This needs OpenLDAP built with ITS#8051 in otherwise slapd won't start!
oath_ldap_dn_regex: "^uid=({{ aedir_aeuser_uid_regex }}),cn=({{ aedir_aezone_cn_regex }}),{{ aedir_suffix }}$"

# map slapd role to bind listener parameters
oath_dict:
  provider:
    bind_listener: hotp_validator
    user: ae-dir-otpverify
  consumer:
    bind_listener: bind_proxy
    user: ae-dir-bind-proxy

# which type of bind listener to use
oath_bind_listener: "{{ oath_dict[openldap_role].bind_listener }}"

# System user used to start bind listener
oath_listener_user: "{{ oath_dict[openldap_role].user }}"

# Directory path where OATH-LDAP configuration is stored
oath_ldap_cfg_dir: "{{ aedir_etc }}/oath-ldap"

# Directory path where OATH-LDAP primary keys are stored
oath_ldap_keys_dir: "{{ oath_ldap_cfg_dir }}/primary-keys"

# If variable oath_ldap_key_files is defined all files *.pub and *.key
# found therein are installed to directory defined with oath_ldap_keys_dir
# *.key files should be protected with ansible vault or similar
#oath_ldap_key_files: "{{ inventory_dir }}/files/oath-primary-keys/"

# Directory path where Unix domain socket is created
oath_ldap_socket_dir: "{{ aedir_rundir }}/{{ oath_bind_listener }}"
# Full pathname of Unix domain socket of bind listener
# (set this to empty string for disabling the external bind listeners completely)
oath_ldap_socket_path: "{{ oath_ldap_socket_dir }}/socket"

# user/group to run password self-service web application
# must be in {{ aedir_ldapi_services }}
oath_ldap_oathenroll_web_user: ae-dir-otpenroll
oath_ldap_oathenroll_web_group: ae-dir-otpenroll

