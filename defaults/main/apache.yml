---
# defaults file for roles/ae-dir

#---------------------------------------------------------------------------
# Apache httpd parameters
#---------------------------------------------------------------------------

# FQDN of service interface
apache_service_fqdn: "{{ openldap_service_fqdn }}"

# where to place static config file for slapd (slapd.conf)
#apache_conf: "{{ apache2_config.conf_pathname }}"
apache_conf: "{{ aedir_etc }}/apache2.conf"

# directory used as rundir (for PID etc.)
apache_rundir: "{{ aedir_rundir }}/apache"

# PID filename of Apache
apache_pid_file: "{{ apache_rundir }}/apache.pid"

# system user/group to run web server with
apache_user: "ae-dir-httpd"
apache_group: "ae-dir-httpd"

# Apache ErrorLog value
apache_error_log: "syslog:daemon"
#apache_error_log: "{{ apache2_config.log_dir }}/error.log"

# Apache accesslog file
apache_access_log: "/var/log/ae-apache/access.log"

# Apache LogLevel value
apache_log_level: "info"

# URL path to server-status info provided by mod_status
# (set to empty string to disable)
apache_status_urlpath: "/server-status"

# see https://httpd.apache.org/docs/2.4/mod/mod_log_config.html#formats
apache_log_format: !unsafe '{ \"time\":\"%{%Y-%m-%dT%H:%M:%S%z}t\", \"ip\":\"%h\", \"url\":\"%U\", \"query\":\"%q\", \"method\":\"%m\", \"status\":\"%>s\", \"ua\":\"%{User-agent}i\", \"ref\":\"%{Referer}i\", \"reqid\":\"%L\", \"in\":%I, \"out\":%O, \"rbody\":%B, \"etime\":%D, \"tls_proto\":\"%{SSL_PROTOCOL}x\", \"tls_cipher\":\"%{SSL_CIPHER}x\" }'

# Apache ServerAdmin value
apache_server_admin: "ae-admins@{{ apache_service_fqdn }}"

# which IP nets are allowed to access normal htdocs/
apache_htdocs_requires:
  - "ip 127.0.0.1"
  - "ip ::1"
  - "ip 10.0.0.0/255.0.0.0"
  - "ip 172.16.0.0/255.240.0.0"
  - "ip 192.168.0.0/255.255.0.0"

# which IP nets are allowed to access web2ldap
apache_web2ldap_requires: "{{ apache_htdocs_requires }}"

# which IP nets are allowed to access oathenroll
apache_oath_requires: "{{ apache_htdocs_requires }}"

# which IP nets are allowed to access password self-service
apache_pwd_requires: "{{ apache_htdocs_requires }}"

# Apache TLS protocol/cipher parameters
#
# See Apache docs: https://httpd.apache.org/docs/2.4/mod/mod_ssl.html#sslprotocol
apache_ssl_protocol: "ALL -SSLv2 -SSLv3 -TLSv1 -TLSv1.1"
# See Apache docs: https://httpd.apache.org/docs/2.4/mod/mod_ssl.html#sslciphersuite
apache_ssl_cipher_suite: "HIGH:!aNULL:!kDH:!kECDH:!MD5"

# Path name of CA cert bundle file
apache_cacert_filename: "{{ openldap_cacert_filename }}"

# The server certificate and key files
apache_cert_filename: "{{ openldap_cert_filename }}"
apache_key_filename: "{{ openldap_key_filename }}"
# The full path names on the target system
apache_cacert_pathname: "{{ openldap_cacert_pathname }}"
apache_cert_pathname: "{{ openldap_cert_pathname }}"
apache_key_pathname: "{{ openldap_key_pathname }}"

