<h1>{text_heading}</h1>

{text_error}

<p>
  You reached web2ldap service <strong>{{ openldap_service_fqdn }}</strong> (running on <em>{{ ansible_fqdn }}</em>)
</p>
<ul>
  <li>
    <a class="CommandLink"
      href="/web2ldap/searchform?{{ openldap_ldapi_uri }}/{{ aedir_suffix }}????bindname=">
      Connect to local &AElig;-DIR
    </a>
    (if in doubt, click this!)
  </li>
  <li>
    <a href="/web2ldap.html">web2ldap user guide</a>
  </li>
  <li>
    <a href="/pwd">Password Self-Service</a>
  </li>
{% if oath_ldap_enabled==True %}
  <li>
    <a href="/oath">OATH-LDAP Token Enrollment Service</a>
  </li>
{% endif %}
</ul>

<h2>For admins and auditors</h2>
<ul>
  <li>
    <a class="CommandLink"
       href="/web2ldap/searchform?{{ openldap_ldapi_uri }}/{{ aedir_accesslog_suffix }}????bindname=">
      Search access log
    </a>
    (only &AElig; admins/auditors)
  </li>
  <li>
    <a class="CommandLink"
       href="/web2ldap?{{ openldap_ldapi_uri }}/{{ aedir_suffix }}??sub?(objectClass=pwdPolicy)?bindname=">
      Search password policies
    </a>
  </li>
  <li>
    <a title="Search personal user accounts which did not receive welcome e-mail yet"
       class="CommandLink"
       href="/web2ldap?{{ openldap_ldapi_uri }}/{{ aedir_suffix }}??sub?(&(objectClass=aeUser)(aeStatus=0)(aeTag=pub-tag-no-welcome-yet))?bindname=">
      No welcome e-mail yet
    </a>
  </li>
</ul>

<h2>&AElig;-DIR configuration</h2>
<table>
  <tr>
    <td>base DN / search root:</td>
    <td>{{ aedir_suffix }}</td>
  </tr>
  <tr>
    <td>POSIX-UID number range:</td>
    <td>{{ aedir_min_uid }}..{{ aedir_max_uid }}</td>
  </tr>
  <tr>
    <td>POSIX-GID number range:</td>
    <td>{{ aedir_min_gid }}..{{ aedir_max_gid }}</td>
  </tr>
</table>

<h2>&AElig;-DIR remote servers</h2>
{% for role in ['provider', 'consumer'] %}
<h3>{{ role }}(s)</h3>
<table>
  <tr>
    <th>Service</th>
    <th>Host</th>
    <th>Id</th>
  </tr>
{% for host in aedir_hosts[role] %}
{% set replica = hostvars[host].get('openldap_service_fqdn',host) -%}
{% set server_id = hostvars[host].get('openldap_server_id','') -%}
  <tr>
    <td>
      <a class="CommandLink" href="/web2ldap/searchform?ldaps://{{ replica }}/{{ aedir_suffix }}????bindname=">{{ replica }}</a>
    </td>
{% if replica!=host %}
    <td>
      {{ host }}
    </td>
{% else %}
    <td>
      -
    </td>
{% endif %}
    <td>
      {{ server_id }}
    </td>
  </tr>
{% endfor %}
</table>

{% endfor %}
