#-----------------------------------------------------------------------
# initiate:   systemctl enable passmod.service
# start:      systemctl start passmod.service
# get status: systemctl status passmod.service
#
# {{ ansible_managed }}
#-----------------------------------------------------------------------

[Unit]
Description=aedirpwd - Password change interceptor listener
Requires=network.target local-fs.target remote-fs.target
After=local-fs.target remote-fs.target network.target
#Wants=ldap.service
#After=ldap.service

[Service]
Type=simple
#PIDFile=
Environment="LDAPTLS_CACERT={{ aedir_pwsync_cacert_pathname }}"
ExecStart={{ aedir_python }} {{ aedir_sbin }}/passmod.py "{{ aedir_pwsync_socket_path }}" "{{ openldap_ldapi_uri }}????x-saslmech=EXTERNAL" "{{ aedir_pwsync_targeturl }}" "{{ aedir_pwsync_targetpwfile }}"
User={{ aedir_pwsync_listener_user }}
Group={{ aedir_pwsync_listener_user }}

[Install]
WantedBy=multi-user.target
