---
# vars file for roles/ae-dir-server

# the release version (semantic versioning scheme)
aedir_version: '0.1.0'

# map real LSB id to another LSB id to be used during plays
lsb_id_map:
  openSUSE: "SUSE"
  RedHatEnterpriseServer: "CentOS"

# which repos on https://download.opensuse.org to use for openSUSE or SLES versions
aedir_suse_repo:
  "SUSE Linux Enterprise Server 15": "http://download.opensuse.org/repositories/home:/stroeder:/AE-DIR/SLE_15/"
  "openSUSE Leap 15.0": "http://download.opensuse.org/repositories/home:/stroeder:/AE-DIR/openSUSE_Leap_15.0/"
  "openSUSE Tumbleweed": "http://download.opensuse.org/repositories/home:/stroeder:/AE-DIR/openSUSE_Tumbleweed/"

aedir_package_repos:
  CentOS:
    "ltb_project_org":
      repo: "https://ltb-project.org/rpm/$releasever/$basearch"
      key: "RPM-GPG-KEY-LTB-project"
  Debian:
    "ltb_project_org":
      repo: "deb https://ltb-project.org/debian/{{ ansible_distribution_release }} {{ ansible_distribution_release }} main"
      key: "RPM-GPG-KEY-LTB-project"
  SUSE:
    "home_stroeder_AE-DIR":
      repo: "{{ aedir_suse_repo.get(ansible_lsb.description, '') }}"
      key: ""

# currently used Python version
aedir_python_version:
  CentOS: "2.7"
  Debian: "2.7"
  SUSE: "2.7"

# OS-specific Python paths
aedir_python_paths:
  CentOS:
    python_exec: "{{ aedir_prefix }}/bin/python{{ aedir_python_version[lsb_id_map.get(ansible_lsb.id,ansible_lsb.id)] }}"
    site_packages: "{{ aedir_prefix }}/lib/python{{ aedir_python_version[lsb_id_map.get(ansible_lsb.id,ansible_lsb.id)] }}/site-packages"
  Debian:
    python_exec: "{{ aedir_prefix }}/bin/python{{ aedir_python_version[lsb_id_map.get(ansible_lsb.id,ansible_lsb.id)] }}"
    site_packages: "{{ aedir_prefix }}/lib/python{{ aedir_python_version[lsb_id_map.get(ansible_lsb.id,ansible_lsb.id)] }}/site-packages"
  SUSE:
    python_exec: "/usr/bin/python{{ aedir_python_version[lsb_id_map.get(ansible_lsb.id,ansible_lsb.id)] }}"
    site_packages: "/usr/lib/python{{ aedir_python_version[lsb_id_map.get(ansible_lsb.id,ansible_lsb.id)] }}/site-packages"

# Maximum incoming LDAP PDU size for authenticated sessions
openldap_sockbuf_max_incoming_auth_default:
  provider: 4194304
  consumer: 262143

# OS-specific maps
os_openldap_paths:
  CentOS:
    # LTB-based installation
    openldap_prefix: /usr/local/openldap
    openldap_conf_prefix: /usr/local/openldap/etc/openldap
    openldap_data: /usr/local/openldap/var/openldap-data
    openldap_rundir: /usr/local/openldap/var/run
    openldap_slapd_exec: /usr/local/openldap/libexec/slapd
    openldap_libdir: /usr/local/openldap/lib64
    openldap_modules: /usr/local/openldap/libexec/openldap
  Debian:
    # LTB-based installation
    openldap_prefix: /usr/local/openldap
    openldap_conf_prefix: /usr/local/openldap/etc/openldap
    openldap_data: /usr/local/openldap/var/openldap-data
    openldap_rundir: /usr/local/openldap/var/run
    openldap_slapd_exec: /usr/local/openldap/libexec/slapd
    openldap_libdir: /usr/local/openldap/lib64
    openldap_modules: /usr/local/openldap/libexec/openldap
  SUSE:
    # openSUSE packages
    openldap_prefix: /usr
    openldap_conf_prefix: /etc/openldap
    openldap_data: /var/lib/ldap
    openldap_rundir: /var/run/slapd
    openldap_slapd_exec: /usr/lib64/slapd
    openldap_libdir: /usr/lib64
    openldap_modules: /usr/lib64/openldap

cron_config:
  CentOS:
    service_name: "crond"
    pkg_name: "cronie"
  Debian:
    service_name: "cron"
    pkg_name: "cron"
  SUSE:
    service_name: "cron"
    pkg_name: "cron"

# conf_pathname: where to place the monolithic apache configuration file
# mod_dir: directory where Apache modules are found
# modules: which modules to load
apache2_config:
  CentOS:
    service_name: "httpd"
    user: "apache"
    group: "apache"
    pid_file: ""
    httpd_exec: "/usr/sbin/httpd"
    conf_pathname: "/etc/httpd/conf/httpd.conf"
    mod_dir: "/usr/lib64/httpd/modules"
    run_dir: "/var/run/httpd"
    modules:
      - socache_shmcb
      - env
      - unixd
      - dir
      - alias
      - ssl
      - mime
      - authz_core
      - authz_host
      - headers
      - deflate
      - filter
      - logio
      - log_config
      - mpm_worker
      - proxy
      - proxy_uwsgi
  Debian:
    service_name: "apache2"
    user: "www-data"
    group: "www-data"
    pid_file: "${APACHE_PID_FILE}"
    httpd_exec: "/usr/sbin/apache2"
    conf_pathname: "/etc/apache2/apache2.conf"
    mod_dir: "/usr/lib/apache2/modules"
    run_dir: "/var/run/apache2"
    modules:
      - mpm_prefork
      - socache_shmcb
      - env
      - dir
      - alias
      - ssl
      - mime
      - authz_core
      - authz_host
      - headers
      - deflate
      - filter
      - proxy
      - proxy_uwsgi
  SUSE:
    service_name: "apache2"
    user: "wwwrun"
    group: "www"
    pid_file: ""
    httpd_exec: "/usr/sbin/httpd-prefork"
    conf_pathname: "/etc/apache2/httpd.conf"
    mod_dir: "/usr/lib64/apache2"
    run_dir: "/var/run/apache2"
    modules:
      - log_config
      - socache_shmcb
      - env
      - dir
      - alias
      - ssl
      - mime
      - authz_core
      - authz_host
      - headers
      - deflate
      - filter
      - logio
      - proxy
      - proxy_uwsgi

web2ldap_paths:
  CentOS:
    configdir: "{{ aedir_prefix }}/etc/web2ldap"
  Debian:
    configdir: "{{ aedir_prefix }}/etc/web2ldap"
  SUSE:
    configdir: "/etc/web2ldap"

# which uwsgi executable to use
uwsgi_paths:
  CentOS:
    exec: "/usr/sbin/uwsgi"
    python_plugin: "/usr/lib64/uwsgi/python_plugin.so"
  Debian:
    exec: "/usr/bin/uwsgi-core"
    python_plugin: "/usr/lib/uwsgi/plugins/python27_plugin.so"
  SUSE:
    exec: "/usr/sbin/uwsgi"
    python_plugin: "/usr/lib64/uwsgi/python_plugin.so"
