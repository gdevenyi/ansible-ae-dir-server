---
# vars file for roles/ae-dir-server

# map real LSB id to another LSB id to be used during plays
lsb_id_map:
  openSUSE: "SUSE"
  RedHatEnterpriseServer: "CentOS"

# Service name for OpenLDAP slapd process
openldap_service_name: "ae-slapd"

# Maximum incoming LDAP PDU size for authenticated sessions
openldap_sockbuf_max_incoming_auth_default:
  provider: 4194304
  consumer: 262143

# system-specific limited replacement for @resources
systemcallfilter_resources: "{{ '@resources' if ansible_lsb.id not in ('openSUSE', 'SUSE') or ansible_lsb.description=='openSUSE Tumbleweed' else 'sched_setparam sched_setscheduler sched_setaffinity setpriority setrlimit set_mempolicy migrate_pages move_pages mbind sched_setattr' }}"

# values for SystemCallFilter= (see systemd.exec(5) for details)
systemd_systemcallfilter:
  default: "~ @clock @cpu-emulation @debug @keyring @module @mount @raw-io @reboot @swap @obsolete @chown @privileged {{ systemcallfilter_resources }} @pkey @setuid @timer"
  apache: "~ @clock @cpu-emulation @debug @keyring @module @mount @raw-io @reboot @swap @obsolete @chown @privileged {{ systemcallfilter_resources }} @pkey @setuid"
  gunicorn: "~ @clock @cpu-emulation @debug @keyring @module @mount @raw-io @reboot @swap @obsolete {{ systemcallfilter_resources }} @pkey @timer fork"
  slapdsock: "~ @clock @cpu-emulation @debug @keyring @module @mount @raw-io @reboot @swap @obsolete @chown @privileged {{ systemcallfilter_resources }} @pkey @setuid @timer fork"
